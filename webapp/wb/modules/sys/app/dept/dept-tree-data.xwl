{"hidden":true,"children":[{"configs":{"serverScript":"/*\n此处生成部门的同步树，如果部门数量很多可以生成异步树。\n异步树请参考m?xwl=examples/templates/employee/edit示例。\n异步树可以通过SQL递归获得所有子部门，详见m?xwl=examples/basic/coding/database/recursive模块说明。\n生成树数据源可以直接使用Wb.buildTree方法，此具使用代码实现用于演示目的。\n*/\nvar result = {},\n  records = {},\n  showCheck = app.getBool('check'),\n  record, nodes, rs, meta;\n\nrs = app.run('select * from WB_DEPT order by ORDER_INDEX');\nmeta = rs.getMetaData();\nwhile (rs.next()) {\n  record = Wb.getRecord(rs, meta);\n  Wb.apply(record, {\n    text: record.DEPT_NAME,\n    id:record.DEPT_ID,\n    iconCls: 'db_field_icon'\n  });\n  if (showCheck)\n    record.checked = false;\n  nodes = records[record.PARENT_DEPT];\n  if (nodes) {\n    nodes.push(record);\n  } else {\n    nodes = [record];\n    records[record.PARENT_DEPT] = nodes;\n  }\n}\n\nfunction createNodes(items, parentDept) {\n  items.children = records[parentDept] || [];\n  if (items.children.length)\n    items.expanded = true; //默认节点展开\n  Wb.each(items.children, function(item) {\n    createNodes(item, item.DEPT_ID);\n  });\n}\ncreateNodes(result, '0');\napp.send(result);","itemId":"module"},"expanded":false,"children":[],"type":"module"}],"roles":{},"title":"部门树数据","iconCls":"","inframe":false,"pageLink":""}