{"hidden":true,"children":[{"configs":{"itemId":"module","serverScript":"var fileHtml, id = app.get('sys.id'),\n  fileName = app.get('file1__name'),\n  fileExt = FileUtil.getFileExt(fileName).toLowerCase();\nswitch (fileExt) {\n  case 'png':\n  case 'jpg':\n  case 'gif':\n  case 'bmp':\n    var img, width, height, maxSize, rate, bs = SysUtil.toByteArrayInputStream(app.get('file1'));\n    try {\n      img = javax.imageio.ImageIO.read(bs);\n      width = img.getWidth();\n      height = img.getHeight();\n    } catch (e) {\n      width = 200;\n      height = 150;\n    }\n    maxSize = width;\n    if (width > 750) {\n      rate = maxSize / 750;\n      width = Math.round(width / rate);\n      height = Math.round(height / rate);\n    }\n    fileHtml = Wb.format('<img title=\"%s\" width=\"%spx\" height=\"%spx\" src=\"m?xwl=dev/otherinfo/community/download-file&type=image&id=%s\"/>', fileName, width, height, id);\n    bs.reset();\n    app.set('file1', bs);\n    break;\n  default:\n    fileHtml = '<a href=\"javascript:Wb.download(\\'m?xwl=dev/otherinfo/community/download-file&type=download&id=' + id + '\\')\">' + StringUtil.toHTML(fileName) + '<\/a>';\n}\napp.run('insert into WB_BBS_FILE values ({?sys.id?},{?sys.date?},{?file1__name?},{?numeric.file1__size?},{?blob.file1?})');\napp.send(fileHtml);"},"expanded":true,"children":[],"type":"module"}],"roles":{},"title":"上传文件","iconCls":"","inframe":false,"pageLink":""}