{"hidden":true,"children":[{"configs":{"itemId":"module","serverScript":"//引入公共库\napp.execute('m?xwl=dev/datainfo/SQL/dbm/utils');\n\nvar allObjects, connection, prefix, sqlTpl;\n\nfunction getNames(sql) {\n  var names = [],\n    st, rs;\n  try {\n    st = connection.createStatement();\n    sql = StringUtil.replaceAll(sql, '{' + '#prefix#' + '}', prefix);\n    rs = st.executeQuery(sql);\n    while (rs.next()) {\n      names.push(rs.getString(1));\n    }\n  } finally {\n    DbUtil.close(rs);\n    DbUtil.close(st);\n  }\n  return names;\n}\n\nconnection = DbUtil.getConnection(app.get('jndi'));\ntry {\n  sqlTpl = app.getSqlTpl(connection);\n  if (!sqlTpl) {\n    app.send('');\n    return;\n  }\n  allObjects = {};\n  Wb.each(getNames(sqlTpl.prefix), function(name) {\n    prefix = name;\n    allObjects[prefix] = Wb.unique(Wb.merge(getNames(sqlTpl.table), getNames(sqlTpl.view),\n      getNames(sqlTpl.sp), getNames(sqlTpl.fn), getNames(sqlTpl.tr)));\n  });\n} finally {\n  DbUtil.close(connection);\n}\napp.send(allObjects);"},"expanded":true,"children":[],"type":"module"}],"roles":{},"title":"获取所有对象","iconCls":"","inframe":false,"pageLink":""}