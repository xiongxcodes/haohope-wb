{"hidden":true,"children":[{"configs":{"serverScript":"var isCut = app.getBool('isCut'),\n  src = Wb.decode(app.get('src')),\n  dst = new File(app.get('dst')),\n  newDst, isDir, result = [];\nWb.each(src, function(file) {\n  file = new File(file);\n  if (isCut) {\n    checkPerm(file, dst);\n    FileUtil.syncMove(file, dst);\n    newDst = new File(dst, file.getName());\n  } else {\n    //复制文件是如果在同一目录内自动重命名\n    newDst = new File(dst, file.getName());\n    if (file.getParentFile().equals(dst)) {\n      newDst = FileUtil.getUniqueFile(newDst);\n    }\n    checkPerm(file, newDst);\n    FileUtil.syncCopyA(file, newDst);\n  }\n  isDir = newDst.isDirectory();\n  result.push({\n    text: newDst.getName(),\n    leaf: !isDir,\n    icon: isDir ? null : WebUtil.encode(FileUtil.getPath(newDst)),\n    type: FileUtil.getFileType(newDst),\n    date: Wb.createDate(newDst.lastModified()),\n    size: isDir ? null : newDst.length()\n  });\n});\napp.send(result);\n\nfunction checkPerm(file1, file2) {\n  if (app.allowBasePath) {\n    if (!FileUtil.isAncestor(app.allowBasePath, file1) || !FileUtil.isAncestor(app.allowBasePath, file2))\n      SysUtil.accessDenied(request);\n  }\n}","itemId":"module"},"expanded":false,"children":[],"type":"module"}],"roles":{},"title":"粘贴文件","iconCls":"","inframe":false,"pageLink":""}