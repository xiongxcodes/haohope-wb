{"hidden":true,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"win","dialog":"true","resizable":"true","width":"1000","title":"选择文件","iconCls":"explorer_icon","height":"450","maximizable":"true"},"expanded":true,"children":[{"configs":{"itemId":"fileModule","file":"file"},"expanded":false,"children":[],"type":"xwl"}],"type":"window","events":{"hide":"Ext.callback(app.hideEvent, app, [app]);","afterrender":"app.fileModule.fileNameBar.setVisible(true);\napp.fileModule.statusBar.setVisible(false);\napp.fileModule.dblClickFileHandler = app.done;","show":"Ext.callback(app.showEvent, app, [app]);","ok":"app.done();"}}],"type":"module","events":{"initialize":"Wb.apply(app, {\n  /** 打开文件，详见show方法 */\n  open: function(callback, params) {\n    app.show(callback, params);\n  },\n  /** 保存文件，详见show方法 */\n  save: function(callback, params) {\n    app.show(callback, Wb.apply({\n      isSave: true\n    }), params);\n  },\n  /**\n   * 显示文件对话框。\n   * @param {Function} callback 回调函数。入参filenames和win。\n   * @param {Object} [params] 可选参数。\n   * @param {Boolean} [params.isSave] 是否为保存文件操作。默认为false，表示打开文件操作。\n   * @param {Boolean} [params.multiSelect] 是否可以多选，仅适用于打开模式。\n   * @param {String} [params.path] 显示文件对话框时，转到的路径。\n   * @param {String} [params.extName] 文件扩展名。\n   * @param {String} [params.iconCls] 文件对话框图标。\n   * @param {String} [params.title] 文件标题。\n   * @param {Function} [params.showEvent] 显示窗口时执行的方法。\n   * @param {Function} [params.hideEvent] 隐藏窗口时执行的方法。   \n   */\n  show: function(callback, params) {\n    var selModel = app.fileModule.fileGrid.selModel,\n      selCallback = params.path ? function() {\n        app.fileModule.selectPath(Wb.getPath(params.path));\n      } : Ext.emptyFn;\n    selModel.deselectAll();\n    app.isSave = params.isSave;\n    app.multiSelect = !params.isSave && params.multiSelect;\n    selModel.setSelectionMode(app.multiSelect ? 'MULTI' : 'SINGLE');\n    app.fileModule.fileNameText.setValue('');\n    app.callback = callback;\n    app.extName = params.extName;\n    app.showEvent = params.showEvent;\n    app.hideEvent = params.hideEvent;\n    if (params.extName) {\n      app.fileModule.gridStore.addFilter({\n        filterFn: function(item) {\n          var name = item.data.text;\n          return !item.data.leaf || name.substring(name.lastIndexOf('.')) == params.extName;\n        }\n      });\n    } else\n      app.fileModule.gridStore.clearFilter();\n    app.win.show();\n    if (params.title)\n      app.win.setTitle(params.title);\n    else\n      app.win.setTitle(params.isSave ? '保存' : '打开');\n    if (params.iconCls)\n      app.win.setIconCls(params.iconCls);\n    else\n      app.win.setIconCls(params.isSave ? 'save_icon' : 'open_icon');\n    if (app.fileModule.fileTree.getRootNode().isLoaded())\n      Wb.reload(app.fileModule.fileTree, selCallback);\n    setTimeout(function() {\n      app.fileModule.fileNameText.focus(false);\n    }, 300);\n  },\n  //完成事件\n  done: function() {\n    if (app.fileModule.fileNameText.getValue()) {\n      var filenames = app.fileModule.getFileNames(false, false, app.isSave ? app.extName : null, true);\n      if (!app.multiSelect)\n        filenames = filenames[0];\n      Ext.callback(app.callback, app, [filenames, app.win]);\n    } else\n      Wb.warn('文件名称不能为空。');\n  }\n});"}}],"roles":{},"title":"打开对话框","iconCls":"","inframe":false,"pageLink":""}