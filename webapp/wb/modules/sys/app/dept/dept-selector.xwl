{"hidden":true,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"win","dialog":"true","resizable":"true","width":"500","iconCls":"org_icon","height":"450","maximizable":"true"},"expanded":true,"children":[{"configs":{"itemId":"tree1","root":"{\n  text: '全部',\n  DEPT_ID: '0',\n  checked: false,\n  iconCls: 'db_field_icon',\n  expanded: true\n}","region":"center"},"expanded":true,"children":[{"configs":{"itemId":"store","fields":"['text', 'DEPT_NAME', 'DEPT_ID', 'PARENT_DEPT', 'ORDER_INDEX']","url":"m?xwl=sys/app/dept/dept-tree-data&check=1"},"expanded":false,"children":[],"type":"treestore"}],"type":"tree","events":{"checkchange":"if (Ext.EventObject.ctrlKey || node.isRoot()) {\n  node.cascadeBy(function(child) {\n    child.set('checked', checked);\n  });\n}"}}],"type":"window","events":{"afterrender":"var bar = win.down('toolbar');\nbar.insert(0, [{\n  xtype: 'tbtext',\n  text: '<span style=\"color:gray\">提示：按 Ctrl 键可以实现级联选择<\/span>'\n}, '->']);","ok":"var recs = Ext.Array.remove(app.tree1.getChecked(), app.tree1.getRootNode()),\n  deptId = Wb.pluck(recs, 'DEPT_ID'),\n  deptName = Wb.pluck(recs, 'DEPT_NAME');\nExt.callback(app.callback, app, [deptId, deptName, win]);"}}],"type":"module","events":{"initialize":"Wb.apply(app, {\n  /**\n   * 显示部门选择对话框。\n   * @param {Function} callback 点击确定按钮后的回调函数。\n   * @param {String[]} callback.deptId 部门id列表。\n   * @param {String[]} callback.deptName 部门名称列表。\n   * @param {Ext.window.Window} callback.win 窗口对象。\n   * @param {Object} [params] 可选参数。\n   * @param {String} [params.title] 窗口标题。\n   * @param {String[]} [params.deptId] 已经选择的部门id列表。\n   */\n  show: function(callback, params) {\n    if (!params)\n      params = {};\n    app.callback = callback;\n    app.win.show();\n    app.win.setTitle(params.title || '部门选择');\n    app.setChecked(params.deptId);\n  },\n  //选中指定部门的节点\n  setChecked: function(deptIds) {\n    var idMap = Wb.toObject(deptIds);\n    Ext.suspendLayouts();\n    app.tree1.getRootNode().cascadeBy(function(node) {\n      node.set('checked', !!idMap[node.data.DEPT_ID]);\n    });\n    Ext.resumeLayouts(true);\n  }\n});"}}],"roles":{},"title":"部门选择","iconCls":"","inframe":false,"pageLink":""}