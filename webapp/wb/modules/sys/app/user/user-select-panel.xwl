{"hidden":true,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"hbox","itemId":"viewport1"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"panel1","flex":"1","title":"可选择用户"},"expanded":true,"children":[{"configs":{"isConfig":"true","itemId":"tbar"},"expanded":true,"children":[{"configs":{"itemId":"searchLabel","xtype":"tbtext","text":"搜索："},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"searchText","flex":"1","emptyText":"用户或显示名称"},"expanded":false,"children":[],"type":"text","events":{"change":"app.sourceStore.load({\n  params: {\n    query: app.searchText.getValue()\n  }\n});"}},{"configs":{"itemId":"delBtn","glyph":"f00d","buttonStyle":"default","tooltip":"重置搜索"},"expanded":false,"children":[],"type":"button","events":{"click":"Wb.reset(app.searchText);"}}],"type":"toolbar"},{"configs":{"itemId":"sourceGrid","viewConfig":"{\n  plugins: {\n    ptype: 'gridviewdragdrop'\n  },\n  listeners: {\n    beforedrop: function(node, data, dropRec, dropPosition) {\n      return data.view != app.sourceGrid.view;\n    },\n    drop: function() {\n      Wb.refreshRowNum(app.sourceGrid);\n    }\n  }\n}","multiSelect":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","normalName":"sourceStore","url":"m?xwl=sys/app/user/select-user"},"expanded":false,"children":[],"type":"store","events":{"success":"var idMap, userId, recs = [];\nif (app.dataLoaded) {\n  userId = Wb.pluck(app.destStore.getRange(), 'USER_ID');\n} else {\n  userId = app.userId;\n  app.dataLoaded = true;\n}\nif (Wb.isEmpty(userId))\n  return;\nidMap = Wb.toObject(userId);\napp.sourceStore.each(function(rec) {\n  if (idMap[rec.data.USER_ID])\n    recs.push(rec);\n});\napp.sourceStore.remove(recs);"}},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"rowNumCol","xtype":"rownumberer"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"userNameCol","dataIndex":"USER_NAME","width":"150","text":"用户名称"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"dispNameCol","dataIndex":"DISPLAY_NAME","flex":"1","text":"显示名称"},"expanded":false,"children":[],"type":"column"}],"type":"array"}],"type":"grid","events":{"itemdblclick":"Wb.moveTo(app.sourceGrid, app.destGrid);"}}],"type":"panel"},{"configs":{"itemId":"container1","defaults":"{\n  margin: '0 0 10 0',\n  width: 30\n}","width":"40","layoutType":"vboxPackCenter"},"expanded":true,"children":[{"configs":{"itemId":"inclBtn","buttonStyle":"default","text":">"},"expanded":false,"children":[],"type":"button","events":{"click":"Wb.moveTo(app.sourceGrid, app.destGrid);"}},{"configs":{"itemId":"inclAllBtn","buttonStyle":"default","text":">>"},"expanded":false,"children":[],"type":"button","events":{"click":"Wb.moveTo(app.sourceGrid, app.destGrid, true);"}},{"configs":{"itemId":"exclBtn","buttonStyle":"default","text":"<"},"expanded":false,"children":[],"type":"button","events":{"click":"Wb.moveTo(app.destGrid, app.sourceGrid);"}},{"configs":{"itemId":"exclAllBtn","buttonStyle":"default","text":"<<"},"expanded":false,"children":[],"type":"button","events":{"click":"Wb.moveTo(app.destGrid, app.sourceGrid, true);"}}],"type":"container"},{"configs":{"itemId":"destGrid","flex":"1","pagingBar":"false","viewConfig":"{\n  plugins: {\n    ptype: 'gridviewdragdrop'\n  },\n  listeners: {\n    drop: function() {\n      Wb.refreshRowNum(app.destGrid);\n    }\n  }\n}","title":"已选择用户","multiSelect":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","normalName":"destStore","pageSize":"-1","url":"m?xwl=sys/app/user/select-specific-users"},"expanded":false,"children":[],"type":"store"},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"rowNumCol","xtype":"rownumberer"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"userNameCol","dataIndex":"USER_NAME","width":"150","text":"用户名称"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"dispNameCol","dataIndex":"DISPLAY_NAME","flex":"1","text":"显示名称"},"expanded":false,"children":[],"type":"column"}],"type":"array"}],"type":"grid","events":{"itemdblclick":"Wb.moveTo(app.destGrid, app.sourceGrid);"}}],"type":"viewport"}],"type":"module","events":{"initialize":"Wb.apply(app, {\n  /**\n   * 加载用户列表。\n   * @param {Array} selectedUserList 已经选择的用户id列表。\n   */\n  load: function(selectedUserList) {\n    app.userId = selectedUserList;\n    app.dataLoaded = false;\n    app.sourceStore.load();\n    if (!Wb.isEmpty(selectedUserList)) {\n      app.destStore.load({\n        params: {\n          userId: selectedUserList\n        }\n      });\n    }\n  }\n});"}}],"roles":{},"title":"用户选择面板","iconCls":"","inframe":false,"pageLink":""}