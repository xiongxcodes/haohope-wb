{"hidden":true,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"win","dialog":"true","resizable":"true","width":"700","maximizable":"true","height":"400"},"expanded":true,"children":[{"configs":{"itemId":"grid1","pagingBar":"false"},"expanded":true,"children":[{"configs":{"itemId":"store","fields":"['itemId', {\n  name: 'date',\n  type: 'date',\n  dateFormat: Wb.dateFormat\n}, 'userId', 'userName', 'userDispName', 'node', 'title', 'action']"},"expanded":false,"children":[],"type":"store"},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"rowNumCol","xtype":"rownumberer"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"dateCol","renderer":"var iconCls;\nswitch (record.data.action) {\n  case 'pass':\n    iconCls = 'ok';\n    break;\n  case 'reject':\n    iconCls = 'minus';\n    break;\n  case 'beforeSign':\n    iconCls = 'record_edit';\n    break;\n  case 'plusSign':\n    iconCls = 'file_edit';\n    break;\n  case 'afterSign':\n    iconCls = 'table_edit';\n    break;\n  case 'turn':\n    iconCls = 'set';\n    break;\n}\nreturn Wb.getIcon(iconCls + '_icon') + Wb.dateToText(value);","dataIndex":"date","width":"170","text":"日期"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"nodeCol","dataIndex":"node","flex":"1","minWidth":"200","text":"节点名称","maxWidth":"400"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"dispNameCol","dataIndex":"userDispName","width":"150","text":"用户"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"actionCol","dataIndex":"action","width":"120","keyName":"flowAction","text":"动作类型"},"expanded":false,"children":[],"type":"column"}],"type":"array"}],"type":"grid","events":{"selectionchange":"var rec = selected[0];\nif (rec)\n  Wb.setTitle(app.win, rec.data.node);"}}],"type":"window","events":{"hide":"app.store.removeAll();","ok":"var rec = app.grid1.getSelection()[0];\nif (!rec) {\n  Wb.warn('请选择需要退回到的节点。');\n  return;\n}\nExt.callback(app.callback, app, [rec.data.itemId, win]);"}}],"type":"module","events":{"initialize":"Wb.apply(app, {\n  /**\n   * 显示退回操作对话框。\n   * @param {Function} callback 点击确定按钮后的回调函数。\n   * @param {String[]} callback.id 选择项的id号。\n   * @param {Ext.window.Window} callback.win 窗口对象。\n   * @param {Object} [params] 可选参数。\n   * @param {Array} params.rows 历史数据记录。\n   * @param {String} [params.title] 窗口标题。\n   * @param {String} [params.iconCls] 窗口图标。\n   */\n  show: function(callback, params) {\n    if (!params)\n      params = {};\n    var rows = [],\n      nodes = {};\n    app.callback = callback;\n    app.win.show();\n    app.win.setTitle(params.title || '退回');\n    app.win.setIconCls(params.iconCls || 'minus_icon');\n    //去掉节点重复的历史记录\n    Wb.each(params.rows, function(row) {\n      if (!nodes[row.node]) {\n        nodes[row.node] = 1;\n        rows.push(row);\n      }\n    });\n    app.store.loadData(rows);\n    app.grid1.setSelection(app.store.last());\n  }\n});"}}],"roles":{},"title":"退回对话框","iconCls":"","inframe":false,"pageLink":""}