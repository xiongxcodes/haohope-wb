{"hidden":false,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"itemId":"store","normalName":"moduleStore","fields":"['text', 'path', 'fileName', 'inframe', 'pageLink']","url":"m?xwl=sys/portal/home/get-tree"},"expanded":true,"children":[],"type":"treestore","events":{"success":"app.loadNavIcons();\napp.loadApps();"}},{"configs":{"layout":"border","itemId":"viewport1"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"centerComp","style":"background:white;","region":"center"},"expanded":false,"children":[],"type":"container"},{"configs":{"itemId":"northComp","padding":"8","weight":"90","html":"<table><tr>\n  <td><img src=\"wb/images/site/html5.gif\"><\/td>\n  <td width=\"10px\"><\/td>\n  <td><span style=\"font-size:36px;color:white;\">{#Var.sys.app.title#}<\/span><\/td>\n  <\/tr><\/table>","style":"background-image:url(wb/images/site/bg1.gif)","region":"north","height":"90"},"expanded":false,"children":[],"type":"comp"},{"configs":{"itemId":"westComp","tplDisplay":"{text}","viewType":"icon","width":"110","weight":"80","region":"west","tplIcon":"wb/images/icon/web.png"},"expanded":true,"children":[{"configs":{"itemId":"store","normalName":"iconStore","fields":"['text', 'path', 'fileName', 'inframe', 'pageLink']"},"expanded":false,"children":[],"type":"store"}],"type":"dataview","events":{"itemclick":"app.openModule(Wb.toUrl(record.data.path));"}},{"configs":{"layout":"hbox","itemId":"southComp","style":"background:#fafafa;border:1px solid #ccc;","region":"south","height":"180"},"expanded":true,"children":[{"configs":{"itemId":"scrollLeft","handler":"app.turnLeft","text":"<span class=\"wb_glyph\" style=\"color:gray;\">&#xf053;<\/span>"},"expanded":false,"children":[],"type":"button"},{"configs":{"layout":"hbox","itemId":"portletsComp","flex":"1"},"expanded":false,"children":[],"type":"container"},{"configs":{"itemId":"scrollRight","handler":"app.turnRight","text":"<span class=\"wb_glyph\" style=\"color:gray;\">&#xf054;<\/span>"},"expanded":false,"children":[],"type":"button"}],"type":"container"},{"configs":{"itemId":"eastComp","padding":"10","width":"300","style":"background:#ce8;","html":"<p style='font-size:13px;'>通知待办<\/p>\n<hr class=\"wb_hr\">\n<ul>\n  <li>待处理的邮件 3 封。<\/li>\n  <li>工作流需要审批 5 项<\/li>\n  <li>费用报销已经成功处理<\/li>\n<\/ul>\n<p style='font-size:13px;'>常用链接<\/p>\n<hr class=\"wb_hr\">\n<ul>\n  <li>用户管理<\/li>\n  <li>文件管理器<\/li>\n  <li>数据库浏览器<\/li>\n<\/ul>","region":"east"},"expanded":false,"children":[],"type":"container"}],"type":"viewport","events":{"afterrender":"app.moduleStore.load();"}}],"type":"module","events":{"initialize":"Wb.apply(app, {\n  //隐藏的当前Portlet索引号,\n  hiddenIndex: 0,\n  //模拟滚动Portlets视图\n  doTurn: function(toRight) {\n    var i, j, items = app.portletsComp.items.items,\n      len = items.length;\n    if (toRight)\n      app.hiddenIndex++;\n    else\n      app.hiddenIndex--;\n    if (app.hiddenIndex < 0)\n      app.hiddenIndex = 0;\n    if (app.hiddenIndex > len - 1)\n      app.hiddenIndex = len - 1;\n    Math.min(app.hiddenIndex, app.portletsComp.items.items.length);\n    Ext.suspendLayouts();\n    for (i = 0; i < len; i++) {\n      if (i < app.hiddenIndex)\n        items[i].hide();\n      else\n        items[i].show();\n    }\n    Ext.resumeLayouts(true);\n  },\n  //向左滚动\n  turnLeft: function() {\n    app.doTurn(false);\n  },\n  //向右滚动\n  turnRight: function() {\n    app.doTurn(true);\n  },\n  //加载左侧应用图标\n  loadNavIcons: function() {\n    var adminNode = app.store.getRootNode().findChild('path', 'admin'); //以管理工具目录为根节点\n    adminNode.eachChild(function(node) {\n      app.iconStore.add(node.data);\n    });\n  },\n  //打开指定的模块\n  openModule: function(url) {\n    //删除容器内所有控件\n    app.centerComp.removeAll();\n    //销毁模块所有资源\n    if (app.currentModule)\n      Wb.destroy(app.currentModule, app.centerComp);\n    //动态运行并加载模块\n    Wb.run({\n      url: url,\n      contextOwner: app.centerComp,\n      success: function(scope) {\n        var entry = Wb.optMain(scope);\n        app.currentModule = scope;\n        if (entry)\n          app.centerComp.add(entry);\n      }\n    });\n  },\n  //加载底部的应用列表\n  loadApps: function() {\n    var i = 0,\n      widgetsNode = app.store.getRootNode().findChild('path', 'examples/basic/portlets', true); //以小饰件目录为根节点\n    widgetsNode.eachChild(function(node) {\n      var comp = app.portletsComp.add({\n        xtype: 'container',\n        width: 230,\n        margin: 10,\n        layout: 'fit'\n      });\n      Wb.run({\n        url: Wb.toUrl(node.data.path),\n        contextOwner: comp,\n        success: function(scope) {\n          var entry = Wb.optMain(scope);\n          app['portlets_' + i++] = scope; //注册到app后，随模块关闭自动释放portlet资源\n          if (entry)\n            comp.add(entry);\n        }\n      });\n    });\n  }\n});"}}],"roles":{},"title":"门户","iconCls":"","inframe":false,"pageLink":""}