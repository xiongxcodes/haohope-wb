{"hidden":false,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"border","itemId":"viewport1"},"expanded":true,"children":[{"configs":{"border":"true","itemId":"keytree","split":"true","root":"{\n  text: '全部',\n  id: '0',\n  expanded: true,\n  value: '0'\n}","columnLines":"true","width":"350","region":"west","title":"RedisKey","tools":"Wb.getTreeTools({search:true})","collapsible":"true","rootVisible":"true","rowLines":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","fields":"['text', 'name', 'id', 'parentid','value']","url":"m?xwl=dev/datainfo/NoSQL/redis/key-tree"},"expanded":false,"children":[],"type":"treestore"},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"keyname","xtype":"treecolumn","dataIndex":"text","flex":"1","text":"键"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"actionColumns","xtype":"actioncolumn","width":"40","align":"center"},"expanded":true,"children":[{"configs":{"itemId":"items"},"expanded":true,"children":[{"configs":{"itemId":"delAction","handler":"Wb.del(app.keytree, {\n  url: 'm?xwl=dev/datainfo/NoSQL/redis/delkey',\n  titleField: 'text'\n});","hideable":"true","tooltip":"删除","iconCls":"folder_delete_icon"},"expanded":false,"children":[],"type":"column"}],"type":"array"}],"type":"column"}],"type":"array"}],"type":"tree","events":{"selectionchange":"if(!selected)return;\nvar node = selected[0];\nif(!node)return;\nvar leaf = node.data.leaf;\nvar value = node.data.value;\napp.treenode = node;\nif(true===leaf){\n   Wb.request({\n    url: 'm?xwl=dev/datainfo/NoSQL/redis/keyinfo',\n    params: {key:value},\n    success: function(data) {\n      var responseText = data.responseText;\n      var jsondata = Wb.decode(responseText);\n      var type = jsondata.type;\n      var value = jsondata.value;\n      jsondata.value = JSON.stringify(value);\n      jsondata.tmpvalue =  jsondata.value;\n      //jsondata.value = app.formatJson(value);//JSON.stringify(value);\n      Wb.setValue(app.redisObjPanel,jsondata);\n      if('string'!==type && 'none'!==type && 'steam'!==type){\n         //app.jsonformat.setDisabled(false);\n         app.value.setReadOnly(true);\n      }else{\n         //app.jsonformat.setDisabled(true);\n         app.value.setReadOnly(false);\n      }\n    }\n  });\n  app.key.setReadOnly(true);\n  app.type.setReadOnly(true);\n  app.value.setReadOnly(true);\n  app.savebtn.setDisabled(true);\n  app.jsonformat.setDisabled(false);\n  app.restore.setDisabled(false);\n}else{\n   //app.jsonformat.setDisabled(true);\n   Wb.setValue(app.redisObjPanel,{key:\"\",value:\"\",type:\"\",til:\"\",size:\"\",tmpvalue:\"\"});\n   //app.key.setValue(value);\n   app.key.setReadOnly(false);\n   app.type.setReadOnly(false);\n   app.value.setReadOnly(false);\n   app.savebtn.setDisabled(false);\n   app.jsonformat.setDisabled(true);\n   app.restore.setDisabled(true);\n}\n"}},{"configs":{"border":"true","layout":"border","itemId":"redisObjPanel","tbar":"app.tbar","region":"center","title":"RedisValue","autoStyle":"true"},"expanded":true,"children":[{"configs":{"layout":"vbox","itemId":"generalSet","collapsed":"false","title":"基础信息","region":"north","collapsible":"true","height":"150"},"expanded":true,"children":[{"configs":{"itemId":"key","allowBlank":"false","fieldLabel":"key","readOnly":"true"},"expanded":true,"children":[],"type":"text"},{"configs":{"itemId":"type","allowBlank":"false","fieldLabel":"类型","displayField":"text","readOnly":"true","valueField":"value","forceSelection":"true"},"expanded":false,"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=dev/datainfo/NoSQL/redis/redistype-list"},"expanded":false,"children":[],"type":"store"}],"type":"combo"},{"configs":{"itemId":"size","fieldLabel":"大小","readOnly":"true"},"expanded":true,"children":[],"type":"text"},{"configs":{"itemId":"til","fieldLabel":"过期时间","readOnly":"true"},"expanded":false,"children":[],"type":"text"}],"type":"fieldset"},{"configs":{"layout":"border","itemId":"valueSet","html":"<div id=\"json\"><\/div>","title":"value值","region":"center","collapsible":"true"},"expanded":false,"children":[{"configs":{"itemId":"toolbar1","region":"north"},"expanded":true,"children":[{"configs":{"itemId":"savebtn","buttonStyle":"info","disabled":"true","text":"保存"},"expanded":false,"children":[],"type":"item","events":{"click":"if(Wb.verify(app.redisObjPanel)){\n   var key = app.key.getValue();\n   if('0'!==app.treenode.data.value && ''!==app.treenode.data.value){\n     key = app.treenode.data.value+\":\"+app.key.getValue();\n   }\n   Wb.request({\n    url: 'm?xwl=dev/datainfo/NoSQL/redis/key-save',\n    params: {key:key,type:app.type.getValue(),value:app.value.getValue()},\n    success: function(data) {\n      var responseText = data.responseText;\n      var jsondata = Wb.decode(responseText);\n      Wb.setValue(app.redisObjPanel,{key:\"\",value:\"\",type:\"\",til:\"\",size:\"\",tmpvalue:\"\"});\n      app.keytree.getStore().load();\n    }\n  });\n}"}},{"configs":{"itemId":"item1","text":"->"},"expanded":false,"children":[],"type":"item"},{"configs":{"itemId":"jsonformat","buttonStyle":"info","tooltip":"美化","text":"美化"},"expanded":false,"children":[],"type":"item","events":{"click":"app.value.setValue(Wb.beautyJson(app.tmpvalue.getValue()));"}},{"configs":{"itemId":"restore","buttonStyle":"info","tooltip":"还原","text":"还原"},"expanded":false,"children":[],"type":"item","events":{"click":"app.value.setValue(app.tmpvalue.getValue());"}}],"type":"toolbar"},{"configs":{"itemId":"value","allowBlank":"false","readOnly":"true","region":"center"},"expanded":false,"children":[],"type":"textarea"},{"configs":{"itemId":"tmpvalue","hidden":"true"},"expanded":false,"children":[],"type":"textarea"}],"type":"fieldset"}],"type":"panel"}],"type":"viewport","events":{"afterrender":"app.navKey = new Ext.KeyNav({\n  viewport: app.viewport1,\n  E: {\n    ctrl: true,\n    fn: function() {\n      app.newBtn.fireEvent('click');\n    }\n  }\n});"}}],"type":"module","events":{"initialize":"Wb.apply(app,{\n  formatJson : function (json, options) {\n    var reg = null,\n            formatted = '',\n            pad = 0,\n            PADDING = '    ';\n    options = options || {};\n    options.newlineAfterColonIfBeforeBraceOrBracket = (options.newlineAfterColonIfBeforeBraceOrBracket === true) ? true : false;\n    options.spaceAfterColon = (options.spaceAfterColon === false) ? false : true;\n    if (typeof json !== 'string') {\n        json = JSON.stringify(json);\n    } else {\n        json = JSON.parse(json);\n        json = JSON.stringify(json);\n    }\n    reg = /([\\{\\}])/g;\n    json = json.replace(reg, '\\r\\n$1\\r\\n');\n    reg = /([\\[\\]])/g;\n    json = json.replace(reg, '\\r\\n$1\\r\\n');\n    reg = /(\\,)/g;\n    json = json.replace(reg, '$1\\r\\n');\n    reg = /(\\r\\n\\r\\n)/g;\n    json = json.replace(reg, '\\r\\n');\n    reg = /\\r\\n\\,/g;\n    json = json.replace(reg, ',');\n    if (!options.newlineAfterColonIfBeforeBraceOrBracket) {\n        reg = /\\:\\r\\n\\{/g;\n        json = json.replace(reg, ':{');\n        reg = /\\:\\r\\n\\[/g;\n        json = json.replace(reg, ':[');\n    }\n    if (options.spaceAfterColon) {\n        reg = /\\:/g;\n        json = json.replace(reg, ':');\n    }\n    (json.split('\\r\\n')).forEach(function (node, index) {\n        var i = 0,\n                indent = 0,\n                padding = '';\n \n        if (node.match(/\\{$/) || node.match(/\\[$/)) {\n            indent = 1;\n        } else if (node.match(/\\}/) || node.match(/\\]/)) {\n            if (pad !== 0) {\n                pad -= 1;\n            }\n        } else {\n            indent = 0;\n        }\n \n        for (i = 0; i < pad; i++) {\n            padding += PADDING;\n        }\n \n        formatted += padding + node + '\\r\\n';\n        pad += indent;\n    }\n    );\n    return formatted;\n}\n\n});"}}],"roles":{},"title":"Redis","iconCls":"f2dd","inframe":false,"pageLink":""}