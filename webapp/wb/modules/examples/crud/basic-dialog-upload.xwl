{"hidden":false,"children":[{"configs":{"itemId":"module"},"expanded":true,"children":[{"configs":{"layout":"fit","itemId":"win","focusControl":"STRING_FIELD","editWin":"true","width":"664","title":"增删改查"},"expanded":true,"children":[{"configs":{"itemId":"form1","flat":"true","layoutType":"tableColumn2"},"expanded":true,"children":[{"configs":{"allowBlank":"false","itemId":"STRING_FIELD","fieldLabel":"字符串"},"expanded":false,"children":[],"type":"text"},{"configs":{"itemId":"INT_FIELD","fieldLabel":"整数"},"expanded":false,"children":[],"type":"number"},{"configs":{"itemId":"DOUBLE_FIELD","fieldLabel":"浮点数"},"expanded":false,"children":[],"type":"number"},{"configs":{"itemId":"DATETIME_FIELD","fieldLabel":"日期时间"},"expanded":false,"children":[],"type":"datetime"},{"configs":{"itemId":"BOOL_FIELD","fieldLabel":"布尔字段","keyName":"bool"},"expanded":false,"children":[],"type":"combo"},{"configs":{"layout":"hbox","itemId":"fieldcontainer1","fieldLabel":"二进制"},"expanded":true,"children":[{"configs":{"itemId":"BLOB_FIELD","flex":"1"},"expanded":false,"children":[],"type":"file"},{"configs":{"itemId":"delFileBtn","margin":"0 0 0 3","text":"删除"},"expanded":false,"children":[],"type":"button","events":{"click":"Wb.removeFile(app.BLOB_FIELD); //重置文件控件并标识需删除，详见Wb.removeFile API文档说明"}}],"type":"fieldcontainer"},{"configs":{"colspan":"2","itemId":"CLOB_FIELD","fieldLabel":"大文本字段","height":"200"},"expanded":false,"children":[],"type":"textarea"}],"type":"form"}],"type":"window","events":{"ok":"var values = Wb.getValue(app.win);\nif (app.isEdit) {\n  //点击修改按钮的处理过程\n  var params = Wb.applyIf(values, Wb.getData(app.selRec, true));\n\n  //使用表单上传时，清除同名的blob参数值，优先使用blob文件上传内容，可使用方法Wb.clearFileItem(params, win); \n  // 该例可直接删除BLOB_FIELD参数即可\n  delete params.BLOB_FIELD;\n  Wb.upload({\n    url: 'm?xwl=examples/crud/crud-db-access/update',\n    form: app.form1,\n    params: params,\n    success: function(form, action, value) {\n      Wb.update(app.selRec, Wb.applyIf(Wb.decode(value), values));\n      app.win.close();\n    }\n  });\n} else {\n  //点击添加按钮的处理过程\n  Wb.upload({\n    url: 'm?xwl=examples/crud/crud-db-access/insert',\n    form: app.form1,\n    success: function(form, action, value) {\n      Wb.add(app.grid1, Wb.applyIf(Wb.decode(value), values));\n      app.win.close();\n    }\n  });\n}"}},{"configs":{"layout":"fit","itemId":"viewport1"},"expanded":true,"children":[{"configs":{"itemId":"grid1","multiSelect":"true"},"expanded":true,"children":[{"configs":{"itemId":"store","autoLoad":"true","url":"m?xwl=examples/crud/crud-db-access/basic-select"},"expanded":false,"children":[],"type":"store"},{"configs":{"itemId":"tbar"},"expanded":true,"children":[{"configs":{"itemId":"newBtn","tooltip":"添加新的记录","text":"添加","iconCls":"record_add_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"app.win.show();\napp.win.setTitle('添加');\napp.win.setIconCls('record_add_icon');\napp.isEdit = false; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性"}},{"configs":{"itemId":"editBtn","tooltip":"修改选择的记录","text":"修改","iconCls":"record_edit_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"var sels = app.grid1.getSelection();\nif (sels.length != 1) {\n  Wb.warn('请选择 1 条需要修改的记录。');\n  return;\n}\napp.selRec = sels[0];\napp.win.show();\napp.win.setTitle('修改 - ' + app.selRec.data.STRING_FIELD);\napp.win.setIconCls('record_edit_icon');\nWb.setValue(app.win, app.selRec.data);\napp.isEdit = true; //标识是否为添加或修改状态，在editWin的ok事件中用到此属性"}},{"configs":{"itemId":"delBtn","tooltip":"删除选择的记录","text":"删除","iconCls":"record_delete_icon"},"expanded":false,"children":[],"type":"item","events":{"click":"Wb.del(app.grid1, {\n  url: 'm?xwl=examples/crud/crud-db-access/delete',\n  titleField: 'STRING_FIELD'\n});"}}],"type":"toolbar"},{"configs":{"itemId":"columns"},"expanded":true,"children":[{"configs":{"itemId":"rowNumCol","xtype":"rownumberer"},"expanded":false,"children":[],"type":"column"},{"configs":{"itemId":"stringCol","dataIndex":"STRING_FIELD","width":"150","text":"字符串字段"},"expanded":true,"children":[],"type":"column"},{"configs":{"itemId":"numCols","text":"数字列"},"expanded":true,"children":[{"configs":{"itemId":"intCol","dataIndex":"INT_FIELD","text":"整数字段","align":"right","titleAlign":"left"},"expanded":true,"children":[],"type":"column"},{"configs":{"itemId":"doubleCol","dataIndex":"DOUBLE_FIELD","text":"浮点数字段","align":"right","titleAlign":"left"},"expanded":true,"children":[],"type":"column"}],"type":"column"},{"configs":{"itemId":"boolCol","dataIndex":"BOOL_FIELD","keyName":"bool","text":"布尔字段"},"expanded":true,"children":[],"type":"column","events":{"afterrender":"return Wb.kv();"}},{"configs":{"itemId":"datetimeCol","dataIndex":"DATETIME_FIELD","width":"170","text":"日期时间字段"},"expanded":true,"children":[],"type":"column"},{"configs":{"itemId":"clobCol","dataIndex":"CLOB_FIELD","flex":"1","text":"大文本字段","autoWrap":"true"},"expanded":true,"children":[],"type":"column"},{"configs":{"itemId":"blobCol","dataIndex":"BLOB_FIELD","text":"二进制字段"},"expanded":true,"children":[],"type":"column"}],"type":"array"}],"type":"grid","events":{"itemdblclick":"app.editBtn.fireEvent('click');"}}],"type":"viewport"}],"type":"module"}],"roles":{},"title":"基本对话框上传","iconCls":"","inframe":false,"pageLink":""}